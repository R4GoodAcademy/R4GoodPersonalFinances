# simulating a scenario

    Code
      print(scenario, n = Inf, width = Inf)
    Output
      # A tibble: 71 x 22
         index years_left date        year survival_prob hm$older$age $younger$age
         <dbl>      <dbl> <date>     <dbl>         <dbl>        <dbl>        <dbl>
       1     0         70 2020-07-15  2020       1                 40           30
       2     1         69 2021-07-15  2021       1.00              41           31
       3     2         68 2022-07-15  2022       1.00              42           32
       4     3         67 2023-07-15  2023       1.00              43           33
       5     4         66 2024-07-15  2024       1.00              44           34
       6     5         65 2025-07-15  2025       0.999             45           35
       7     6         64 2026-07-15  2026       0.999             46           36
       8     7         63 2027-07-15  2027       0.999             47           37
       9     8         62 2028-07-15  2028       0.999             48           38
      10     9         61 2029-07-15  2029       0.998             49           39
      11    10         60 2030-07-15  2030       0.998             50           40
      12    11         59 2031-07-15  2031       0.998             51           41
      13    12         58 2032-07-15  2032       0.997             52           42
      14    13         57 2033-07-15  2033       0.997             53           43
      15    14         56 2034-07-15  2034       0.996             54           44
      16    15         55 2035-07-15  2035       0.996             55           45
      17    16         54 2036-07-15  2036       0.995             56           46
      18    17         53 2037-07-15  2037       0.994             57           47
      19    18         52 2038-07-15  2038       0.993             58           48
      20    19         51 2039-07-15  2039       0.992             59           49
      21    20         50 2040-07-15  2040       0.991             60           50
      22    21         49 2041-07-15  2041       0.990             61           51
      23    22         48 2042-07-15  2042       0.989             62           52
      24    23         47 2043-07-15  2043       0.987             63           53
      25    24         46 2044-07-15  2044       0.985             64           54
      26    25         45 2045-07-15  2045       0.983             65           55
      27    26         44 2046-07-15  2046       0.980             66           56
      28    27         43 2047-07-15  2047       0.977             67           57
      29    28         42 2048-07-15  2048       0.974             68           58
      30    29         41 2049-07-15  2049       0.970             69           59
      31    30         40 2050-07-15  2050       0.966             70           60
      32    31         39 2051-07-15  2051       0.961             71           61
      33    32         38 2052-07-15  2052       0.956             72           62
      34    33         37 2053-07-15  2053       0.950             73           63
      35    34         36 2054-07-15  2054       0.943             74           64
      36    35         35 2055-07-15  2055       0.935             75           65
      37    36         34 2056-07-15  2056       0.926             76           66
      38    37         33 2057-07-15  2057       0.916             77           67
      39    38         32 2058-07-15  2058       0.905             78           68
      40    39         31 2059-07-15  2059       0.892             79           69
      41    40         30 2060-07-15  2060       0.878             80           70
      42    41         29 2061-07-15  2061       0.862             81           71
      43    42         28 2062-07-15  2062       0.844             82           72
      44    43         27 2063-07-15  2063       0.824             83           73
      45    44         26 2064-07-15  2064       0.801             84           74
      46    45         25 2065-07-15  2065       0.777             85           75
      47    46         24 2066-07-15  2066       0.749             86           76
      48    47         23 2067-07-15  2067       0.720             87           77
      49    48         22 2068-07-15  2068       0.687             88           78
      50    49         21 2069-07-15  2069       0.651             89           79
      51    50         20 2070-07-15  2070       0.613             90           80
      52    51         19 2071-07-15  2071       0.572             91           81
      53    52         18 2072-07-15  2072       0.529             92           82
      54    53         17 2073-07-15  2073       0.483             93           83
      55    54         16 2074-07-15  2074       0.436             94           84
      56    55         15 2075-07-15  2075       0.388             95           85
      57    56         14 2076-07-15  2076       0.340             96           86
      58    57         13 2077-07-15  2077       0.292             97           87
      59    58         12 2078-07-15  2078       0.245             98           88
      60    59         11 2079-07-15  2079       0.201             99           89
      61    60         10 2080-07-15  2080       0.160            100           90
      62    61          9 2081-07-15  2081       0.124             NA           91
      63    62          8 2082-07-15  2082       0.0923            NA           92
      64    63          7 2083-07-15  2083       0.0660            NA           93
      65    64          6 2084-07-15  2084       0.0450            NA           94
      66    65          5 2085-07-15  2085       0.0290            NA           95
      67    66          4 2086-07-15  2086       0.0176            NA           96
      68    67          3 2087-07-15  2087       0.00998           NA           97
      69    68          2 2088-07-15  2088       0.00521           NA           98
      70    69          1 2089-07-15  2089       0.00248           NA           99
      71    70          0 2090-07-15  2090       0.00107           NA          100
         income$income_older $income_younger total_income spending$spending1
                       <dbl>           <dbl>        <dbl>              <dbl>
       1                   0               0            0               6000
       2                   0               0            0               6000
       3                   0               0            0               6000
       4                   0               0            0               6000
       5                 100             200          300               6000
       6                 100             200          300               6000
       7                 300             200          500               6000
       8                 300             200          500               6000
       9                 300             200          500               6000
      10                 300             200          500               6000
      11                 300             200          500               6000
      12                 300             200          500               6000
      13                 300             200          500               6000
      14                 300             200          500               6000
      15                 300             200          500               6000
      16                 300             200          500               6000
      17                 300             200          500               6000
      18                 300             200          500               6000
      19                 300             200          500               6000
      20                 300             200          500               6000
      21                 300             200          500               6000
      22                 300             200          500               6000
      23                 300             200          500               6000
      24                 300             200          500               6000
      25                 300             200          500               6000
      26                 300             200          500               6000
      27                 300             200          500               6000
      28                 300             200          500               6000
      29                 300             200          500               6000
      30                 300             200          500               6000
      31                 300             200          500               6000
      32                 300             200          500               6000
      33                 300             200          500               6000
      34                 300             200          500               6000
      35                 300             200          500               6000
      36                 300             200          500               6000
      37                 300             200          500               6000
      38                 300             200          500               6000
      39                 300             200          500               6000
      40                 300             200          500               6000
      41                 300             200          500               6000
      42                 300             200          500               6000
      43                 300             200          500               6000
      44                 300             200          500               6000
      45                 300             200          500               6000
      46                 300             200          500               6000
      47                 300             200          500               6000
      48                 300             200          500               6000
      49                 300             200          500               6000
      50                 300             200          500               6000
      51                 300             200          500               6000
      52                 300             200          500               6000
      53                 300             200          500               6000
      54                 300             200          500               6000
      55                 300             200          500               6000
      56                 300             200          500               6000
      57                 300             200          500               6000
      58                 300             200          500               6000
      59                 300             200          500               6000
      60                 300             200          500               6000
      61                 300             200          500               6000
      62                   0             200          200               6000
      63                   0             200          200               6000
      64                   0             200          200               6000
      65                   0             200          200               6000
      66                   0             200          200               6000
      67                   0             200          200               6000
      68                   0             200          200               6000
      69                   0             200          200               6000
      70                   0             200          200               6000
      71                   0             200          200               6000
         nondiscretionary_spending human_capital liabilities financial_wealth
                             <dbl>         <dbl>       <dbl>            <dbl>
       1                      6000        11634.     171125.          375000 
       2                      6000        12012.     170484.          372472.
       3                      6000        12402.     169821.          369855.
       4                      6000        12804.     169137.          367146.
       5                      6000        13220.     168431.          364343.
       6                      6000        13339.     167702.          361752.
       7                      6000        13462.     166949.          359070.
       8                      6000        13382.     166172.          356502.
       9                      6000        13301.     165369.          353845.
      10                      6000        13216.     164541.          351096.
      11                      6000        13129.     163686.          348251.
      12                      6000        13038.     162803.          345307.
      13                      6000        12945.     161891.          342260.
      14                      6000        12849.     160949.          339108.
      15                      6000        12750.     159978.          335847.
      16                      6000        12647.     158974.          332472.
      17                      6000        12541.     157938.          328982.
      18                      6000        12432.     156869.          325371.
      19                      6000        12319.     155764.          321636.
      20                      6000        12203.     154624.          317774.
      21                      6000        12083.     153447.          313781.
      22                      6000        11959.     152232.          309653.
      23                      6000        11830.     150977.          305386.
      24                      6000        11698.     149681.          300977.
      25                      6000        11561.     148344.          296423.
      26                      6000        11420.     146963.          291719.
      27                      6000        11275.     145537.          286863.
      28                      6000        11124.     144065.          281852.
      29                      6000        10969.     142545.          276683.
      30                      6000        10809.     140976.          271354.
      31                      6000        10643.     139356.          265862.
      32                      6000        10473.     137684.          260206.
      33                      6000        10296.     135957.          254386.
      34                      6000        10114.     134174.          248401.
      35                      6000         9926.     132333.          242251.
      36                      6000         9732.     130433.          235938.
      37                      6000         9531.     128470.          229464.
      38                      6000         9325.     126445.          222833.
      39                      6000         9111.     124353.          216049.
      40                      6000         8890.     122194.          209119.
      41                      6000         8663.     119964.          202051.
      42                      6000         8427.     117662.          194855.
      43                      6000         8185.     115286.          187542.
      44                      6000         7934.     112832.          180125.
      45                      6000         7675.     110299.          172622.
      46                      6000         7408.     107683.          165050.
      47                      6000         7132.     104983.          157430.
      48                      6000         6848.     102195.          149785.
      49                      6000         6554.      99316.          142141.
      50                      6000         6250.      96344.          134523.
      51                      6000         5937.      93276.          126962.
      52                      6000         5613.      90108.          119487.
      53                      6000         5279.      86837.          112129.
      54                      6000         4934.      83461.          104917.
      55                      6000         4578.      79974.           97880.
      56                      6000         4210.      76375.           91043.
      57                      6000         3831.      72658.           84425.
      58                      6000         3439.      68821.           78044.
      59                      6000         3034.      64860.           71905.
      60                      6000         2616.      60770.           66009.
      61                      6000         2185.      56547.           60344.
      62                      6000         1740.      52187.           54890.
      63                      6000         1590.      47686.           49308.
      64                      6000         1435.      43039.           43860.
      65                      6000         1275.      38241.           38504.
      66                      6000         1110.      33287.           33192.
      67                      6000          939.      28173.           27879.
      68                      6000          763.      22892.           22520.
      69                      6000          581.      17440.           17078.
      70                      6000          394.      11811.           11520.
      71                      6000          200        6000             5823.
         discretionary_spending total_spending financial_wealth_end risk_tolerance
                          <dbl>          <dbl>                <dbl>          <dbl>
       1                  9679.         15679.             372472.             0.5
       2                  9676.         15676.             369855.             0.5
       3                  9672.         15672.             367146.             0.5
       4                  9668.         15668.             364343.             0.5
       5                  9664.         15664.             361752.             0.5
       6                  9659.         15659.             359070.             0.5
       7                  9655.         15655.             356502.             0.5
       8                  9651.         15651.             353845.             0.5
       9                  9646.         15646.             351096.             0.5
      10                  9641.         15641.             348251.             0.5
      11                  9636.         15636.             345307.             0.5
      12                  9631.         15631.             342260.             0.5
      13                  9625.         15625.             339108.             0.5
      14                  9619.         15619.             335847.             0.5
      15                  9613.         15613.             332472.             0.5
      16                  9606.         15606.             328982.             0.5
      17                  9599.         15599.             325371.             0.5
      18                  9591.         15591.             321636.             0.5
      19                  9582.         15582.             317774.             0.5
      20                  9572.         15572.             313781.             0.5
      21                  9561.         15561.             309653.             0.5
      22                  9549.         15549.             305386.             0.5
      23                  9536.         15536.             300977.             0.5
      24                  9521.         15521.             296423.             0.5
      25                  9504.         15504.             291719.             0.5
      26                  9484.         15484.             286863.             0.5
      27                  9463.         15463.             281852.             0.5
      28                  9438.         15438.             276683.             0.5
      29                  9410.         15410.             271354.             0.5
      30                  9379.         15379.             265862.             0.5
      31                  9343.         15343.             260206.             0.5
      32                  9302.         15302.             254386.             0.5
      33                  9256.         15256.             248401.             0.5
      34                  9203.         15203.             242251.             0.5
      35                  9144.         15144.             235938.             0.5
      36                  9076.         15076.             229464.             0.5
      37                  8999.         14999.             222833.             0.5
      38                  8912.         14912.             216049.             0.5
      39                  8813.         14813.             209119.             0.5
      40                  8702.         14702.             202051.             0.5
      41                  8576.         14576.             194855.             0.5
      42                  8435.         14435.             187542.             0.5
      43                  8276.         14276.             180125.             0.5
      44                  8098.         14098.             172622.             0.5
      45                  7899.         13899.             165050.             0.5
      46                  7678.         13678.             157430.             0.5
      47                  7434.         13434.             149785.             0.5
      48                  7163.         13163.             142141.             0.5
      49                  6867.         12867.             134523.             0.5
      50                  6544.         12544.             126962.             0.5
      51                  6194.         12194.             119487.             0.5
      52                  5817.         11817.             112129.             0.5
      53                  5416.         11416.             104917.             0.5
      54                  4993.         10993.              97880.             0.5
      55                  4552.         10552.              91043.             0.5
      56                  4098.         10098.              84425.             0.5
      57                  3637.          9637.              78044.             0.5
      58                  3177.          9177.              71905.             0.5
      59                  2727.          8727.              66009.             0.5
      60                  2296.          8296.              60344.             0.5
      61                  1891.          7891.              54890.             0.5
      62                  1523.          7523.              49308.             0.5
      63                  1196.          7196.              43860.             0.5
      64                   916.          6916.              38504.             0.5
      65                   684.          6684.              33192.             0.5
      66                   498.          6498.              27879.             0.5
      67                   354.          6354.              22520.             0.5
      68                   245.          6245.              17078.             0.5
      69                   165.          6165.              11520.             0.5
      70                   102.          6102.               5823.             0.5
      71                     0           6000                  24.2            0.5
         smooth_consumption_preference consumption_impatience_preference
                                 <dbl>                             <dbl>
       1                             1                              0.04
       2                             1                              0.04
       3                             1                              0.04
       4                             1                              0.04
       5                             1                              0.04
       6                             1                              0.04
       7                             1                              0.04
       8                             1                              0.04
       9                             1                              0.04
      10                             1                              0.04
      11                             1                              0.04
      12                             1                              0.04
      13                             1                              0.04
      14                             1                              0.04
      15                             1                              0.04
      16                             1                              0.04
      17                             1                              0.04
      18                             1                              0.04
      19                             1                              0.04
      20                             1                              0.04
      21                             1                              0.04
      22                             1                              0.04
      23                             1                              0.04
      24                             1                              0.04
      25                             1                              0.04
      26                             1                              0.04
      27                             1                              0.04
      28                             1                              0.04
      29                             1                              0.04
      30                             1                              0.04
      31                             1                              0.04
      32                             1                              0.04
      33                             1                              0.04
      34                             1                              0.04
      35                             1                              0.04
      36                             1                              0.04
      37                             1                              0.04
      38                             1                              0.04
      39                             1                              0.04
      40                             1                              0.04
      41                             1                              0.04
      42                             1                              0.04
      43                             1                              0.04
      44                             1                              0.04
      45                             1                              0.04
      46                             1                              0.04
      47                             1                              0.04
      48                             1                              0.04
      49                             1                              0.04
      50                             1                              0.04
      51                             1                              0.04
      52                             1                              0.04
      53                             1                              0.04
      54                             1                              0.04
      55                             1                              0.04
      56                             1                              0.04
      57                             1                              0.04
      58                             1                              0.04
      59                             1                              0.04
      60                             1                              0.04
      61                             1                              0.04
      62                             1                              0.04
      63                             1                              0.04
      64                             1                              0.04
      65                             1                              0.04
      66                             1                              0.04
      67                             1                              0.04
      68                             1                              0.04
      69                             1                              0.04
      70                             1                              0.04
      71                             1                              0.04
         time_value_discount discretionary_spending_utility
                       <dbl>                          <dbl>
       1              1                                9.18
       2              0.962                            9.18
       3              0.925                            9.18
       4              0.889                            9.18
       5              0.855                            9.18
       6              0.822                            9.18
       7              0.790                            9.18
       8              0.760                            9.17
       9              0.731                            9.17
      10              0.703                            9.17
      11              0.676                            9.17
      12              0.650                            9.17
      13              0.625                            9.17
      14              0.601                            9.17
      15              0.577                            9.17
      16              0.555                            9.17
      17              0.534                            9.17
      18              0.513                            9.17
      19              0.494                            9.17
      20              0.475                            9.17
      21              0.456                            9.17
      22              0.439                            9.16
      23              0.422                            9.16
      24              0.406                            9.16
      25              0.390                            9.16
      26              0.375                            9.16
      27              0.361                            9.16
      28              0.347                            9.15
      29              0.333                            9.15
      30              0.321                            9.15
      31              0.308                            9.14
      32              0.296                            9.14
      33              0.285                            9.13
      34              0.274                            9.13
      35              0.264                            9.12
      36              0.253                            9.11
      37              0.244                            9.10
      38              0.234                            9.10
      39              0.225                            9.08
      40              0.217                            9.07
      41              0.208                            9.06
      42              0.200                            9.04
      43              0.193                            9.02
      44              0.185                            9.00
      45              0.178                            8.97
      46              0.171                            8.95
      47              0.165                            8.91
      48              0.158                            8.88
      49              0.152                            8.83
      50              0.146                            8.79
      51              0.141                            8.73
      52              0.135                            8.67
      53              0.130                            8.60
      54              0.125                            8.52
      55              0.120                            8.42
      56              0.116                            8.32
      57              0.111                            8.20
      58              0.107                            8.06
      59              0.103                            7.91
      60              0.0989                           7.74
      61              0.0951                           7.55
      62              0.0914                           7.33
      63              0.0879                           7.09
      64              0.0845                           6.82
      65              0.0813                           6.53
      66              0.0781                           6.21
      67              0.0751                           5.87
      68              0.0722                           5.50
      69              0.0695                           5.10
      70              0.0668                           4.63
      71              0.0642                           0   
         discretionary_spending_utility_weighted
                                           <dbl>
       1                                9.18    
       2                                8.82    
       3                                8.48    
       4                                8.16    
       5                                7.84    
       6                                7.54    
       7                                7.25    
       8                                6.96    
       9                                6.70    
      10                                6.44    
      11                                6.19    
      12                                5.95    
      13                                5.71    
      14                                5.49    
      15                                5.28    
      16                                5.07    
      17                                4.87    
      18                                4.68    
      19                                4.50    
      20                                4.32    
      21                                4.15    
      22                                3.98    
      23                                3.82    
      24                                3.67    
      25                                3.52    
      26                                3.38    
      27                                3.24    
      28                                3.10    
      29                                2.97    
      30                                2.85    
      31                                2.72    
      32                                2.60    
      33                                2.49    
      34                                2.38    
      35                                2.27    
      36                                2.16    
      37                                2.05    
      38                                1.95    
      39                                1.85    
      40                                1.75    
      41                                1.66    
      42                                1.56    
      43                                1.47    
      44                                1.37    
      45                                1.28    
      46                                1.19    
      47                                1.10    
      48                                1.01    
      49                                0.924   
      50                                0.838   
      51                                0.753   
      52                                0.671   
      53                                0.592   
      54                                0.515   
      55                                0.442   
      56                                0.373   
      57                                0.310   
      58                                0.252   
      59                                0.199   
      60                                0.154   
      61                                0.115   
      62                                0.0830  
      63                                0.0575  
      64                                0.0380  
      65                                0.0238  
      66                                0.0141  
      67                                0.00777 
      68                                0.00397 
      69                                0.00185 
      70                                0.000767
      71                                0       

